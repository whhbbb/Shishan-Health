{"version":3,"file":"recommendDetail.js","sources":["../../../../../src/pages/recommend/recommendDetail.vue","../../../../../uniPage:/cGFnZXMvcmVjb21tZW5kL3JlY29tbWVuZERldGFpbC52dWU"],"sourcesContent":["<template>\n  <div class=\"out-wrapper\">\n    <!--pages/posts/post-detail/post-detail.wxml-->\n    <scroll-view scroll-y>\n      <view class=\"container\">\n        <view class=\"author-date\">\n          <image class=\"avatar\" :src=\"details?.avatar\"></image>\n          <view class=\"author-view\">\n            <text class=\"author\">{{ details?.nickName }}</text>\n            <text class=\"const-text\">推荐于</text>\n            <text class=\"date\">{{ details?.createTime }}</text>\n          </view>\n          <view v-if=\"details?.status === 3\" class=\"active-recommend\">\n            <image src=\"../../static/recommend/active-recommend.png\" mode=\"heightFix\" />\n          </view>\n        </view>\n\n        <view class=\"activityD\">\n          <text class=\"title\">{{ details?.theme }}</text>\n          <text class=\"date\">主讲人：{{ details?.lecturerName }}</text>\n        </view>\n\n        <view class=\"tool\">\n          <text class=\"text\">{{ details?.content }}</text>\n        </view>\n        <view @tap.stop=\"navToAct\" class=\"activity\">\n          <view class=\"img-wrapper\">\n            <image class=\"activity-img\" :src=\"details.tblActivity.lng\" mode=\"scaleToFill\" />\n          </view>\n          <view class=\"activity-content\">\n            <view class=\"title\">{{ details.tblActivity.userImg2 }}</view>\n            <view class=\"speaker\">主讲人： {{ details.tblActivity.speakerName }}</view>\n          </view>\n        </view>\n        <view class=\"wrapper\">\n          <view class=\"TLC\">\n            <view class=\"dianzannum\" @click=\"iLike(details.id, details.tblLike)\">\n              <!-- <uni-icons v-if=\"details.tblLike == null\" type=\"heart\" size=\"20\"></uni-icons>\n            <uni-icons v-else type=\"heart-filled\" color=\"red\" size=\"20\"></uni-icons> -->\n              <image class=\"dianzan-img\" v-if=\"details.tblLike == null\" src=\"../../static/column/heart.png\"\n                mode=\"scaleToFill\" />\n              <image class=\"dianzan-img\" v-else src=\"../../static/column/heart-active.png\" mode=\"scaleToFill\" />\n              <view>{{ details.likeCount }}</view>\n            </view>\n            <view class=\"comment\">\n              <view @tap=\"showInputBox(details.id)\">\n                <image class=\"comment-img\" src=\"../../static/recommend/comment.png\" mode=\"scaleToFill\" />\n                <text>评论</text>\n              </view>\n            </view>\n          </view>\n\n          <view class=\"zan-name-view\" v-if=\"details.likes.length !== 0\">\n            <image class=\"dianzan-img\" src=\"../../static/column/heart.png\" mode=\"scaleToFill\" />\n            <template v-for=\"(item2, index2) in details.likes\" :key=\"index2\">\n              <text bindtap=\"TouchZanUser\" :data-name=\"item2.nickName\" class=\"zan-user\">\n                {{ item2.nickName }}\n              </text>\n              <text class=\"zan-user\" v-if=\"index2 !== details.likes.length - 1\">,&nbsp;</text>\n            </template>\n          </view>\n\n          <view class=\"line\"></view>\n\n          <view class=\"discuss-view\">\n            <view class=\"discuss\" v-for=\"(item3, index3) in details.tblRecommendCommnets\" :key=\"index3\">\n              <label bindtap=\"TouchZanUser\" :data-name=\"item3.nickName\" class=\"discuss-user\">{{ item3.nickName\n                }}:</label>\n              <label class=\"content\">{{ item3.comment }}</label>\n            </view>\n          </view>\n        </view>\n      </view>\n      <view class=\"input-view\" v-if=\"showInput\">\n        <input class=\"inputstyle\" v-model=\"comment\" type=\"text\" :focus=\"isInputFocused\" placeholder=\"请输入评论\"\n          @blur=\"hideInput\" />\n        <button class=\"btn-view\" :disabled=\"comment === ''\" @click=\"sendcomment\">发送</button>\n      </view>\n    </scroll-view>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { ref, reactive } from 'vue'\nimport { onLaunch, onLoad } from '@dcloudio/uni-app'\nimport { getRecommedDetail, sendLike, deletLike, sendcommen } from '@/services/recommed'\n\ntype ActivityInfo = {\n  userImg2: string\n  speakerName: string\n  lng: string\n  id: number\n}\ntype detailsInfo = {\n  avatar: string\n  nickName: string\n  createTime: string\n  theme: string\n  lecturerName: string\n  content: string\n  status: number\n  id: number\n  tblLike: boolean\n  likeCount: number\n  likes: Array<{ nickName: string }>\n  tblRecommendCommnets: Array<{ nickName: string; comment: string; createTime: string }>\n  tblActivity:ActivityInfo\n}\n\nconst props = defineProps<{\n  id: number\n}>()\nconst details = ref<detailsInfo>()\nconst getD = async (id) => {\n  const res = await getRecommedDetail(id)\n  details.value = res.data\n}\nonLoad(() => {\n  getD(props.id)\n})\n\n//点赞\nconst sendLikeTo = async (id) => {\n  const res = await sendLike(id)\n  if (res.code == 200) {\n    getD(props.id)\n  }\n}\nconst delLike = async (id) => {\n  const res = await deletLike(id)\n  if (res.code == 200) {\n    getD(props.id)\n  }\n}\nconst iLike = (id, tblLike) => {\n  if (uni.getStorageSync('token')) {\n    if (tblLike) {\n      delLike(id)\n    } else {\n      sendLikeTo(id)\n    }\n  } else {\n    wx.showToast({\n      title: '您尚未登录，请先登录',\n      icon: 'none',\n      duration: 1000,\n      complete: () => {\n        setTimeout(() => {\n          uni.navigateTo({\n            url: '/pages/login/login',\n          })\n        }, 1000)\n      },\n    })\n  }\n}\n\n// 跳转活动详情\nconst navToAct = () => {\n  uni.navigateTo({\n    url: `/pages/activity/ActivityDetails?id=${details.value.tblActivity.id}`,\n  })\n}\n\n//评论\nconst showInput = ref(false)\nconst comment = ref('')\nconst currentItemId = ref<number>()\n// 自动弹出键盘\nconst isInputFocused = ref(true)\nconst showInputBox = (itemId) => {\n  if (uni.getStorageSync('token')) {\n    showInput.value = true\n    currentItemId.value = itemId\n  } else {\n    wx.showToast({\n      title: '您尚未登录，请先登录',\n      icon: 'none',\n      duration: 1000,\n      complete: () => {\n        setTimeout(() => {\n          uni.navigateTo({\n            url: '/pages/login/login',\n          })\n        }, 1000)\n      },\n    })\n  }\n}\nconst sendC = async () => {\n  const res = await sendcommen({\n    comment: comment.value,\n    recommendId: currentItemId.value,\n  })\n  if (res.code == 200) {\n    showInput.value = false\n    // 发送评论后隐藏输入框\n    showInput.value = false\n    // 清空评论内容\n    comment.value = ''\n    getD(props.id)\n  }\n}\nconst sendcomment = () => {\n  sendC()\n}\nconst hideInput = () => {\n  showInput.value = false\n  // 发送评论后隐藏输入框\n  showInput.value = false\n}\n\n</script>\n<style scoped lang=\"scss\">\n/* pages/posts/post-detail/post-detail.wxss */\n.out-wrapper {\n  width: 83%;\n  margin: 0 auto;\n  height: fit-content;\n  padding-bottom: 20rpx;\n  .container {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    .author-date {\n      display: flex;\n      margin-top: 25rpx;\n      margin-bottom: 20rpx;\n      width: 100%;\n      align-items: center;\n\n      .avatar {\n        width: 110rpx;\n        height: 110rpx;\n        margin-right: 20rpx;\n        border-radius: 50%;\n      }\n\n      .author-view {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n\n        .author {\n          font-size: 30rpx;\n          font-weight: 300;\n          vertical-align: middle;\n          color: #666;\n        }\n\n        .const-text {\n          font-size: 24rpx;\n          color: #999;\n        }\n\n        .date {\n          margin-top: 2rpx;\n          font-size: 24rpx;\n          vertical-align: middle;\n          color: #999;\n        }\n      }\n\n      .active-recommend {\n        flex: 1;\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        height: 50rpx;\n      }\n    }\n\n    .activityD {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n\n      .title {\n        font-size: 36rpx;\n        font-weight: 700;\n        letter-spacing: 2px;\n        margin-bottom: 8rpx;\n        color: #4b556c;\n      }\n\n      .date {\n        font-size: 25rpx;\n        color: #666;\n      }\n    }\n\n    .tool {\n      line-height: 65rpx;\n      margin: 2vh auto 0;\n      font-size: 34rpx;\n      word-break: break-all;\n      overflow: hidden;\n      text-indent: 60rpx;\n    }\n\n    .activity {\n      margin-top: 15rpx;\n      display: flex;\n      padding: 20rpx;\n      background-color: rgb(245, 245, 245);\n      border-radius: 20rpx;\n      height: 200rpx;\n\n      .img-wrapper {\n        width: 20%;\n        height: 100%;\n        background-color: rgb(88, 103, 138);\n        border-radius: 8rpx;\n        margin-right: 12rpx;\n      }\n\n      .activity-content {\n        flex: 1;\n\n        .title {\n          font-size: 30rpx;\n          color: #000;\n          font-weight: bold;\n          margin: 5rpx 0 10rpx 0;\n        }\n\n        .speaker {\n          font-size: 25rpx;\n          color: #000;\n        }\n      }\n    }\n\n    .wrapper {\n      width: 100%;\n      border-radius: 10rpx;\n      margin: 25rpx auto;\n      padding: 20rpx;\n      background-color: rgb(241, 241, 241);\n\n      .TLC {\n        font-size: 29rpx;\n        width: 90%;\n        display: flex;\n        align-items: center;\n        margin-bottom: 10rpx;\n\n        .dianzannum {\n          display: flex;\n          align-items: center;\n          margin-right: 30rpx;\n\n          .dianzan-img {\n            width: 30rpx;\n            height: 30rpx;\n            margin-right: 5rpx;\n          }\n        }\n\n        .comment {\n          display: flex;\n          align-items: center;\n\n          .comment-img {\n            width: 30rpx;\n            height: 30rpx;\n            margin-right: 5rpx;\n          }\n        }\n      }\n\n      .zan-name-view {\n        display: flex;\n        align-items: center;\n\n        .dianzan-img {\n          width: 20rpx;\n          height: 20rpx;\n          margin-right: 8rpx;\n        }\n\n        .zan-user {\n          font-size: 24rpx;\n          line-height: 40rpx;\n          height: 40rpx;\n          color: rgb(88, 103, 138);\n        }\n      }\n\n      .line {\n        height: 1px;\n        background-color: #ccc;\n        margin-top: 15rpx;\n      }\n\n      .discuss-view {\n        margin-top: 10rpx;\n        display: flex;\n        flex-direction: column;\n        font-size: 24rpx;\n        color: rgb(88, 103, 138);\n\n        .content {\n          color: #000;\n          margin-left: 8rpx;\n        }\n      }\n    }\n  }\n}\n\n.input-view {\n  display: flex;\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n\n  background-color: white;\n}\n\n.inputstyle {\n  width: 80%;\n  height: 40px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n\n  padding-left: 5px;\n}\n\n.btn-view {\n  height: 40px;\n  font-size: medium;\n  border: 1px solid #ccc;\n}\n</style>\n","import MiniProgramPage from '/Users/whhbbb/Documents/Project-storage/xswc_game/src/pages/recommend/recommendDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getRecommedDetail","onLoad","sendLike","deletLike","uni","wx","sendcommen"],"mappings":";;;;;;;;;;;;;AA+GA,UAAM,UAAUA,cAAAA;AACV,UAAA,OAAO,OAAO,OAAO;AACnB,YAAA,MAAM,MAAMC,oCAAkB,EAAE;AACtC,cAAQ,QAAQ,IAAI;AAAA,IAAA;AAEtBC,kBAAAA,OAAO,MAAM;AACX,WAAK,MAAM,EAAE;AAAA,IAAA,CACd;AAGK,UAAA,aAAa,OAAO,OAAO;AACzB,YAAA,MAAM,MAAMC,2BAAS,EAAE;AACzB,UAAA,IAAI,QAAQ,KAAK;AACnB,aAAK,MAAM,EAAE;AAAA,MACf;AAAA,IAAA;AAEI,UAAA,UAAU,OAAO,OAAO;AACtB,YAAA,MAAM,MAAMC,4BAAU,EAAE;AAC1B,UAAA,IAAI,QAAQ,KAAK;AACnB,aAAK,MAAM,EAAE;AAAA,MACf;AAAA,IAAA;AAEI,UAAA,QAAQ,CAAC,IAAI,YAAY;AACzB,UAAAC,cAAA,MAAI,eAAe,OAAO,GAAG;AAC/B,YAAI,SAAS;AACX,kBAAQ,EAAE;AAAA,QAAA,OACL;AACL,qBAAW,EAAE;AAAA,QACf;AAAA,MAAA,OACK;AACLC,sBAAAA,KAAG,UAAU;AAAA,UACX,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU,MAAM;AACd,uBAAW,MAAM;AACfD,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA,cAAA,CACN;AAAA,eACA,GAAI;AAAA,UACT;AAAA,QAAA,CACD;AAAA,MACH;AAAA,IAAA;AAIF,UAAM,WAAW,MAAM;AACrBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,sCAAsC,QAAQ,MAAM,YAAY,EAAE;AAAA,MAAA,CACxE;AAAA,IAAA;AAIG,UAAA,YAAYL,kBAAI,KAAK;AACrB,UAAA,UAAUA,kBAAI,EAAE;AACtB,UAAM,gBAAgBA,cAAAA;AAEhB,UAAA,iBAAiBA,kBAAI,IAAI;AACzB,UAAA,eAAe,CAAC,WAAW;AAC3B,UAAAK,cAAA,MAAI,eAAe,OAAO,GAAG;AAC/B,kBAAU,QAAQ;AAClB,sBAAc,QAAQ;AAAA,MAAA,OACjB;AACLC,sBAAAA,KAAG,UAAU;AAAA,UACX,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU,MAAM;AACd,uBAAW,MAAM;AACfD,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA,cAAA,CACN;AAAA,eACA,GAAI;AAAA,UACT;AAAA,QAAA,CACD;AAAA,MACH;AAAA,IAAA;AAEF,UAAM,QAAQ,YAAY;AAClB,YAAA,MAAM,MAAME,6BAAW;AAAA,QAC3B,SAAS,QAAQ;AAAA,QACjB,aAAa,cAAc;AAAA,MAAA,CAC5B;AACG,UAAA,IAAI,QAAQ,KAAK;AACnB,kBAAU,QAAQ;AAElB,kBAAU,QAAQ;AAElB,gBAAQ,QAAQ;AAChB,aAAK,MAAM,EAAE;AAAA,MACf;AAAA,IAAA;AAEF,UAAM,cAAc,MAAM;AAClB;IAAA;AAER,UAAM,YAAY,MAAM;AACtB,gBAAU,QAAQ;AAElB,gBAAU,QAAQ;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/MpB,GAAG,WAAW,eAAe;"}