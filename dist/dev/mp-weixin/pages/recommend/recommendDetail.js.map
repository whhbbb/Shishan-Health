{"version":3,"file":"recommendDetail.js","sources":["../../../../../src/pages/recommend/recommendDetail.vue","../../../../../uniPage:/cGFnZXMvcmVjb21tZW5kL3JlY29tbWVuZERldGFpbC52dWU"],"sourcesContent":["<template>\r\n  <div>\r\n    <!--pages/posts/post-detail/post-detail.wxml-->\r\n    <view class=\"container\">\r\n      <view class=\"author-date\">\r\n        <image class=\"avatar\" :src=\"details.avatar\"></image>\r\n        <view class=\"author-view\">\r\n          <text class=\"author\">{{ details.nickName }}</text>\r\n          <text class=\"const-text\">推荐于</text>\r\n          <text class=\"date\">{{ details.createTime }}</text>\r\n        </view>\r\n      </view>\r\n\r\n      <view class=\"activityD\">\r\n        <text class=\"title\">{{ details.theme }}</text>\r\n        <text class=\"date\">主讲人：{{ details.lecturerName }}</text>\r\n      </view>\r\n\r\n      <view class=\"tool\">\r\n        <text>{{ details.content }}</text>\r\n      </view>\r\n      <view class=\"wrapper\">\r\n        <view class=\"TLC\">\r\n          <view>\r\n            <uni-icons v-if=\"details.status == 1\" type=\"email-filled\" size=\"20\"></uni-icons>\r\n            <uni-icons v-if=\"details.status == 2\" type=\"auth\" size=\"20\"></uni-icons>\r\n            <uni-icons v-else-if=\"details.status == 3\" type=\"vip-filled\" size=\"20\"></uni-icons>\r\n\r\n            <text v-if=\"details.status == 1\">已推荐</text>\r\n            <text v-if=\"details.status == 2\">已采纳</text>\r\n            <text v-else-if=\"details.status == 3\">有效推荐</text>\r\n          </view>\r\n\r\n          <view class=\"dianzannum\" @click=\"iLike(details.id, details.tblLike)\">\r\n            <uni-icons v-if=\"details.tblLike == null\" type=\"heart\" size=\"20\"></uni-icons>\r\n            <uni-icons v-else type=\"heart-filled\" color=\"red\" size=\"20\"></uni-icons>\r\n            <view>{{ details.likeCount }}</view>\r\n          </view>\r\n\r\n          <view>\r\n            <view @tap=\"showInputBox(details.id)\">\r\n              <uni-icons type=\"chat\" size=\"20\"></uni-icons>\r\n              <text>评论</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"zan-name-view\" v-if=\"details.likes.length !== 0\">\r\n          <uni-icons type=\"heart-filled\" size=\"20\"></uni-icons>\r\n          <template v-for=\"(item2, index2) in details.likes\" :key=\"index2\">\r\n            <text bindtap=\"TouchZanUser\" :data-name=\"item2.nickName\" class=\"zan-user\">{{\r\n              item2.nickName\r\n            }}</text>\r\n            <text class=\"zan-user\" v-if=\"index2 !== details.likes.length - 1\">,</text>\r\n          </template>\r\n        </view>\r\n\r\n        <view class=\"discuss-view\">\r\n          <view\r\n            class=\"discuss\"\r\n            v-for=\"(item3, index3) in details.tblRecommendCommnets\"\r\n            :key=\"index3\"\r\n          >\r\n            <label bindtap=\"TouchZanUser\" :data-name=\"item3.nickName\" class=\"discuss-user\"\r\n              >{{ item3.nickName }}：</label\r\n            >\r\n            <label class=\"content\">{{ item3.comment }}</label>\r\n            <view class=\"date\">{{ item3.createTime }}</view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <view class=\"input-view\" v-if=\"showInput\">\r\n      <input\r\n        class=\"inputstyle\"\r\n        v-model=\"comment\"\r\n        type=\"text\"\r\n        :focus=\"isInputFocused\"\r\n        placeholder=\"请输入评论\"\r\n        @blur=\"hideInput\"\r\n      />\r\n      <button class=\"btn-view\" :disabled=\"comment === ''\" @click=\"sendcomment\">发送</button>\r\n    </view>\r\n  </div>\r\n</template>\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive } from 'vue'\r\nimport { onLaunch, onLoad } from '@dcloudio/uni-app'\r\nimport { getRecommedDetail, sendLike, deletLike, sendcommen } from '@/services/recommed'\r\nconst props = defineProps<{\r\n  id: number\r\n}>()\r\nconst details = ref({})\r\nconst getD = async (id) => {\r\n  const res = await getRecommedDetail(id)\r\n  console.log(res)\r\n  details.value = res.data\r\n}\r\nonLoad(() => {\r\n  getD(props.id)\r\n})\r\n\r\n//点赞\r\nconst sendLikeTo = async (id) => {\r\n  const res = await sendLike(id)\r\n  console.log(res)\r\n  if (res.code == 200) {\r\n    getD(props.id)\r\n  }\r\n}\r\nconst delLike = async (id) => {\r\n  const res = await deletLike(id)\r\n  console.log(res)\r\n  if (res.code == 200) {\r\n    getD(props.id)\r\n  }\r\n}\r\nconst iLike = (id, tblLike) => {\r\n  if (uni.getStorageSync('token')) {\r\n    if (tblLike) {\r\n      console.log('取消点赞！')\r\n      delLike(id)\r\n    } else {\r\n      console.log('点赞')\r\n      sendLikeTo(id)\r\n    }\r\n  } else {\r\n    wx.showToast({\r\n      title: '您尚未登录，请先登录',\r\n      icon: 'none',\r\n      duration: 1000,\r\n      complete: () => {\r\n        setTimeout(() => {\r\n          uni.navigateTo({\r\n            url: '/pages/login/login',\r\n          })\r\n        }, 1000)\r\n      },\r\n    })\r\n  }\r\n}\r\n\r\n//评论\r\nconst showInput = ref(false)\r\nconst comment = ref('')\r\nconst currentItemId = ref<number>()\r\n// 自动弹出键盘\r\nconst isInputFocused = ref(true)\r\nconst showInputBox = (itemId) => {\r\n  if (uni.getStorageSync('token')) {\r\n    console.log('评论')\r\n    console.log(itemId)\r\n    showInput.value = true\r\n    currentItemId.value = itemId\r\n  } else {\r\n    wx.showToast({\r\n      title: '您尚未登录，请先登录',\r\n      icon: 'none',\r\n      duration: 1000,\r\n      complete: () => {\r\n        setTimeout(() => {\r\n          uni.navigateTo({\r\n            url: '/pages/login/login',\r\n          })\r\n        }, 1000)\r\n      },\r\n    })\r\n  }\r\n}\r\nconst sendC = async () => {\r\n  const res = await sendcommen({\r\n    comment: comment.value,\r\n    recommendId: currentItemId.value,\r\n  })\r\n  console.log(res)\r\n  if (res.code == 200) {\r\n    showInput.value = false\r\n    // 发送评论后隐藏输入框\r\n    showInput.value = false\r\n    // 清空评论内容\r\n    comment.value = ''\r\n    getD(props.id)\r\n  }\r\n}\r\nconst sendcomment = () => {\r\n  console.log('点击了发送')\r\n  console.log(currentItemId.value)\r\n  sendC()\r\n}\r\nconst hideInput = () => {\r\n  showInput.value = false\r\n  // 发送评论后隐藏输入框\r\n  showInput.value = false\r\n}\r\n</script>\r\n<style scoped>\r\n/* pages/posts/post-detail/post-detail.wxss */\r\n.container {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n}\r\n.head-container {\r\n  width: 100%;\r\n  height: 460rpx;\r\n  position: relative;\r\n}\r\n.head-image {\r\n  width: 100%;\r\n  height: 460rpx;\r\n}\r\n.audio {\r\n  width: 102rpx;\r\n  height: 110rpx;\r\n  position: absolute;\r\n  top: 50%;\r\n  margin-top: -55rpx;\r\n  left: 50%;\r\n  margin-left: -51rpx;\r\n  opacity: 0.6;\r\n}\r\n.author-date {\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: 3vh auto 0;\r\n  width: 100%;\r\n}\r\n.author-view {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 75%;\r\n  margin-left: 5%;\r\n}\r\n.avatar {\r\n  /* height:100%; */\r\n  width: 100rpx;\r\n  height: 100rpx;\r\n  overflow: hidden;\r\n  vertical-align: middle;\r\n  margin-left: 20rpx;\r\n  border-radius: 15%;\r\n}\r\n.author {\r\n  font-size: 30rpx;\r\n  font-weight: 300;\r\n  vertical-align: middle;\r\n  color: #666;\r\n}\r\n.const-text {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.date {\r\n  margin-top: 2rpx;\r\n  font-size: 24rpx;\r\n  vertical-align: middle;\r\n  color: #999;\r\n}\r\n.title {\r\n  font-size: 36rpx;\r\n  font-weight: 700;\r\n  letter-spacing: 2px;\r\n  margin-bottom: 5rpx;\r\n  color: #4b556c;\r\n}\r\n.tool {\r\n  width: 90%;\r\n  line-height: 65rpx;\r\n  margin: 3vh auto 0;\r\n  font-size: 34rpx;\r\n  word-break: break-all;\r\n  overflow: hidden;\r\n}\r\n.circle-img {\r\n  float: right;\r\n  margin-right: 40rpx;\r\n  vertical-align: middle;\r\n}\r\n\r\n/* .circle-img image{\r\n  width: 90rpx;\r\n  height: 90rpx;\r\n}\r\n.share-img{\r\n  margin-left: 30rpx;\r\n} */\r\n.activityD {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 90%;\r\n  margin: 3vh auto 0;\r\n  /* margin:10px 0; */\r\n}\r\n.horizon {\r\n  width: 660rpx;\r\n  height: 1px;\r\n  background-color: #e5e5e5;\r\n  vertical-align: middle;\r\n  position: relative;\r\n  top: 46rpx;\r\n  margin: 0 auto;\r\n  z-index: -99;\r\n}\r\n\r\n.detail {\r\n  color: #666;\r\n  margin-left: 30rpx;\r\n  margin-top: 20rpx;\r\n  margin-right: 30rpx;\r\n  line-height: 44rpx;\r\n  letter-spacing: 2px;\r\n}\r\n\r\n/* 评论 */\r\n.discuss-view {\r\n  background: rgb(241, 241, 241);\r\n  width: 100%;\r\n  margin-top: 10rpx;\r\n  border-top: 1px solid rgb(213, 213, 213);\r\n  min-height: 20rpx;\r\n  border-bottom-left-radius: 10rpx;\r\n  border-bottom-right-radius: 10rpx;\r\n}\r\n\r\n.discuss {\r\n  background: rgb(241, 241, 241);\r\n  width: 90%;\r\n  margin: 0 auto;\r\n  padding-top: 10rpx;\r\n  padding-bottom: 8rpx;\r\n  word-break: break-all;\r\n  white-space: normal;\r\n  overflow: hidden;\r\n}\r\n\r\n.discuss label {\r\n  font-size: 30rpx;\r\n}\r\n\r\n.discuss-user {\r\n  color: rgb(88, 103, 138);\r\n}\r\n\r\n.content {\r\n  margin-left: 10rpx;\r\n}\r\n.wrapper {\r\n  border-radius: 10rpx;\r\n  width: 90%;\r\n  margin: 3vh auto;\r\n  background-color: rgb(241, 241, 241);\r\n}\r\n.TLC {\r\n  font-size: 29rpx;\r\n  width: 90%;\r\n  margin: 0 auto;\r\n  padding-bottom: 10rpx;\r\n  /* border-bottom: 1px solid rgb(213, 213, 213); */\r\n  height: 70rpx;\r\n  line-height: 70rpx;\r\n  display: flex;\r\n  flex-wrap: row;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  /* background-color: rgb(241, 241, 241); */\r\n  /* */\r\n}\r\n.TlC > view {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.dianzannum {\r\n  display: flex;\r\n  flex-wrap: row;\r\n}\r\n.zan-name-view {\r\n  background-color: rgb(241, 241, 241);\r\n  width: 90%;\r\n  margin: 0 auto;\r\n  padding-bottom: 10rpx;\r\n  margin-bottom: 10rpx;\r\n  overflow-wrap: break-word;\r\n}\r\n.zan-user {\r\n  font-size: 24rpx;\r\n  line-height: 40rpx;\r\n  height: 40rpx;\r\n  color: rgb(88, 103, 138);\r\n}\r\n.input-view {\r\n  display: flex;\r\n  position: absolute;\r\n  bottom: 0;\r\n  width: 100%;\r\n\r\n  background-color: white;\r\n}\r\n.inputstyle {\r\n  width: 80%;\r\n  height: 40px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 5px;\r\n\r\n  padding-left: 5px;\r\n}\r\n.btn-view {\r\n  height: 40px;\r\n  font-size: medium;\r\n  border: 1px solid #ccc;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/feidian/计算机设计大赛/xswc_cs/src/pages/recommend/recommendDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getRecommedDetail","onLoad","sendLike","deletLike","uni","wx","sendcommen"],"mappings":";;;;;;;;;;;;;;;;;;;;;AA4FM,UAAA,UAAUA,kBAAI,CAAA,CAAE;AAChB,UAAA,OAAO,OAAO,OAAO;AACnB,YAAA,MAAM,MAAMC,oCAAkB,EAAE;AACtC,cAAQ,IAAI,GAAG;AACf,cAAQ,QAAQ,IAAI;AAAA,IAAA;AAEtBC,kBAAAA,OAAO,MAAM;AACX,WAAK,MAAM,EAAE;AAAA,IAAA,CACd;AAGK,UAAA,aAAa,OAAO,OAAO;AACzB,YAAA,MAAM,MAAMC,2BAAS,EAAE;AAC7B,cAAQ,IAAI,GAAG;AACX,UAAA,IAAI,QAAQ,KAAK;AACnB,aAAK,MAAM,EAAE;AAAA,MACf;AAAA,IAAA;AAEI,UAAA,UAAU,OAAO,OAAO;AACtB,YAAA,MAAM,MAAMC,4BAAU,EAAE;AAC9B,cAAQ,IAAI,GAAG;AACX,UAAA,IAAI,QAAQ,KAAK;AACnB,aAAK,MAAM,EAAE;AAAA,MACf;AAAA,IAAA;AAEI,UAAA,QAAQ,CAAC,IAAI,YAAY;AACzB,UAAAC,cAAA,MAAI,eAAe,OAAO,GAAG;AAC/B,YAAI,SAAS;AACX,kBAAQ,IAAI,OAAO;AACnB,kBAAQ,EAAE;AAAA,QAAA,OACL;AACL,kBAAQ,IAAI,IAAI;AAChB,qBAAW,EAAE;AAAA,QACf;AAAA,MAAA,OACK;AACLC,sBAAAA,KAAG,UAAU;AAAA,UACX,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU,MAAM;AACd,uBAAW,MAAM;AACfD,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA,cAAA,CACN;AAAA,eACA,GAAI;AAAA,UACT;AAAA,QAAA,CACD;AAAA,MACH;AAAA,IAAA;AAII,UAAA,YAAYL,kBAAI,KAAK;AACrB,UAAA,UAAUA,kBAAI,EAAE;AACtB,UAAM,gBAAgBA,cAAAA;AAEhB,UAAA,iBAAiBA,kBAAI,IAAI;AACzB,UAAA,eAAe,CAAC,WAAW;AAC3B,UAAAK,cAAA,MAAI,eAAe,OAAO,GAAG;AAC/B,gBAAQ,IAAI,IAAI;AAChB,gBAAQ,IAAI,MAAM;AAClB,kBAAU,QAAQ;AAClB,sBAAc,QAAQ;AAAA,MAAA,OACjB;AACLC,sBAAAA,KAAG,UAAU;AAAA,UACX,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU,MAAM;AACd,uBAAW,MAAM;AACfD,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA,cAAA,CACN;AAAA,eACA,GAAI;AAAA,UACT;AAAA,QAAA,CACD;AAAA,MACH;AAAA,IAAA;AAEF,UAAM,QAAQ,YAAY;AAClB,YAAA,MAAM,MAAME,6BAAW;AAAA,QAC3B,SAAS,QAAQ;AAAA,QACjB,aAAa,cAAc;AAAA,MAAA,CAC5B;AACD,cAAQ,IAAI,GAAG;AACX,UAAA,IAAI,QAAQ,KAAK;AACnB,kBAAU,QAAQ;AAElB,kBAAU,QAAQ;AAElB,gBAAQ,QAAQ;AAChB,aAAK,MAAM,EAAE;AAAA,MACf;AAAA,IAAA;AAEF,UAAM,cAAc,MAAM;AACxB,cAAQ,IAAI,OAAO;AACX,cAAA,IAAI,cAAc,KAAK;AACzB;IAAA;AAER,UAAM,YAAY,MAAM;AACtB,gBAAU,QAAQ;AAElB,gBAAU,QAAQ;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/LpB,GAAG,WAAW,eAAe;"}