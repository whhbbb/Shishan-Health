{"version":3,"file":"newsItem.js","sources":["../../../../../../src/pages/column/components/newsItem.vue","../../../../../../uniComponent:/RDovZmVpZGlhbi_orqHnrpfmnLrorr7orqHlpKfotZsveHN3Y19jcy9zcmMvcGFnZXMvY29sdW1uL2NvbXBvbmVudHMvbmV3c0l0ZW0udnVl"],"sourcesContent":["<template>\r\n  <navigator\r\n    :url=\"`/pages/column/components/article?kind=${item.kind}&id=${item.id}`\"\r\n    class=\"post-container\"\r\n    hover-class=\"none\"\r\n    v-for=\"(item, index) in columnContents\"\r\n    :key=\"item.id\"\r\n  >\r\n    <!--  -->\r\n    <image class=\"post-image\" :src=\"item.img\" mode=\"heightFix\"></image>\r\n    <text class=\"post-title\">{{ item.title }}</text>\r\n    <text class=\"post-content\">{{ item.summary }}</text>\r\n    <view class=\"post-like\">\r\n      <view class=\"time\">\r\n        <text>{{ item.createTime }}</text>\r\n      </view>\r\n      <view class=\"hit\">\r\n        <view>\r\n          <uni-icons\r\n            v-if=\"!item.tblLike\"\r\n            @tap.stop=\"likeUp(item.id, item.tblLike)\"\r\n            type=\"heart\"\r\n            size=\"20\"\r\n          ></uni-icons>\r\n          <uni-icons\r\n            v-else\r\n            type=\"heart-filled\"\r\n            size=\"20\"\r\n            @tap.stop=\"likeUp(item.id, item.tblLike)\"\r\n            color=\"red\"\r\n          ></uni-icons>\r\n          <text class=\"post-like-font\">{{ item.likeCount }}</text>\r\n        </view>\r\n        <view>\r\n          <uni-icons type=\"eye-filled\" size=\"20\"></uni-icons>\r\n          <text class=\"post-like-font\">{{ item.viewsNums }}</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </navigator>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, watch, onMounted } from 'vue'\r\nimport { getColumnsAPI, likeUpAPI, likeDownAPI } from '@/services/column'\r\nimport { onShow } from '@dcloudio/uni-app'\r\ntype columnItem = {\r\n  // 精彩专栏编号\r\n  id: number\r\n  // 精彩专栏标题\r\n  title: string\r\n  // 精彩专栏种类\r\n  kind?: string\r\n  // 简介\r\n  summary?: string\r\n  // 内容\r\n  content: string\r\n  // 点赞数\r\n  likeCount: number\r\n  // 浏览数\r\n  viewsNums: number\r\n  // 创建时间\r\n  createTime: string\r\n  // 图片\r\n  img: string\r\n  // 点赞状态\r\n  tblLike?: object\r\n}\r\nconst props = defineProps({\r\n  kind: {\r\n    type: Number,\r\n    default: 1,\r\n  },\r\n})\r\nconst columnContents = ref<columnItem[]>([])\r\n// 点赞或取消点赞\r\nconst likeUp = (id: number, tblLike: object) => {\r\n  // 判断是否有token\r\n  if (uni.getStorageSync('token')) {\r\n    if (tblLike) {\r\n      console.log('取消点赞' + props.kind)\r\n      likeDownAPI(id).then((res) => {\r\n        console.log(res)\r\n        if (res.code === 200) {\r\n          getColumns(props.kind)\r\n          console.log('取消点赞成功')\r\n        }\r\n      })\r\n    } else {\r\n      console.log('点赞' + props.kind)\r\n      likeUpAPI(id).then((res) => {\r\n        console.log(res)\r\n        if (res.code === 200) {\r\n          getColumns(props.kind)\r\n          console.log('点赞成功')\r\n        }\r\n      })\r\n    }\r\n  } else {\r\n    wx.showToast({\r\n      title: '您尚未登录，请先登录',\r\n      icon: 'none',\r\n      duration: 1000,\r\n      complete: () => {\r\n        setTimeout(() => {\r\n          uni.navigateTo({\r\n            url: '/pages/login/login',\r\n          })\r\n        }, 1000)\r\n      },\r\n    })\r\n  }\r\n}\r\n// 获取数据\r\nconst getColumns = async (kind: Number) => {\r\n  const res = await getColumnsAPI({ kind: kind })\r\n  console.log(res)\r\n  if (res.code === 200) {\r\n    columnContents.value = res.rows\r\n  } else {\r\n    uni.showToast({\r\n      title: '获取数据失败',\r\n      icon: 'none',\r\n    })\r\n  }\r\n}\r\nonMounted(() => {\r\n  console.log(props.kind)\r\n  getColumns(props.kind)\r\n})\r\nonShow(() => {\r\n  getColumns(props.kind)\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.post-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 95%;\r\n  margin: 0 auto;\r\n  margin-top: 20rpx;\r\n  // margin-bottom: 40rpx;\r\n  background-color: #fff;\r\n  border-bottom: 1px solid #b5b5b5;\r\n  padding-bottom: 5px;\r\n}\r\n\r\n.post-title {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n  margin-bottom: 10px;\r\n  padding-left: 10rpx;\r\n}\r\n\r\n.post-image {\r\n  max-width: 90vw;\r\n  height: 400rpx;\r\n  margin: 0 auto;\r\n  margin-bottom: 15px;\r\n  border-radius: 5rpx;\r\n}\r\n\r\n.post-content {\r\n  color: #666;\r\n  font-size: 28rpx;\r\n  margin-bottom: 20rpx;\r\n  line-height: 40rpx;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n  overflow: hidden;\r\n}\r\n\r\n.post-like {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: 13px;\r\n  line-height: 16px;\r\n  // margin-left: 10px;\r\n}\r\n\r\n.hit {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  width: 100px;\r\n}\r\n\r\n.time {\r\n  color: #7a7a7a;\r\n  font-size: 25rpx;\r\n  padding-left: 15rpx;\r\n}\r\n\r\n.post-like-image {\r\n  width: 30rpx;\r\n  height: 30rpx;\r\n  margin-right: 8px;\r\n  vertical-align: middle;\r\n}\r\n\r\n.post-like-font {\r\n  vertical-align: middle;\r\n  font-size: 30rpx;\r\n  margin: 0 20px 3rpx 0;\r\n}\r\n</style>\r\n","import Component from 'D:/feidian/计算机设计大赛/xswc_cs/src/pages/column/components/newsItem.vue'\nwx.createComponent(Component)"],"names":["ref","uni","likeDownAPI","likeUpAPI","wx","getColumnsAPI","onMounted","onShow"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA0EM,UAAA,iBAAiBA,kBAAkB,CAAA,CAAE;AAErC,UAAA,SAAS,CAAC,IAAY,YAAoB;AAE1C,UAAAC,cAAA,MAAI,eAAe,OAAO,GAAG;AAC/B,YAAI,SAAS;AACH,kBAAA,IAAI,SAAS,MAAM,IAAI;AAC/BC,0BAAAA,YAAY,EAAE,EAAE,KAAK,CAAC,QAAQ;AAC5B,oBAAQ,IAAI,GAAG;AACX,gBAAA,IAAI,SAAS,KAAK;AACpB,yBAAW,MAAM,IAAI;AACrB,sBAAQ,IAAI,QAAQ;AAAA,YACtB;AAAA,UAAA,CACD;AAAA,QAAA,OACI;AACG,kBAAA,IAAI,OAAO,MAAM,IAAI;AAC7BC,0BAAAA,UAAU,EAAE,EAAE,KAAK,CAAC,QAAQ;AAC1B,oBAAQ,IAAI,GAAG;AACX,gBAAA,IAAI,SAAS,KAAK;AACpB,yBAAW,MAAM,IAAI;AACrB,sBAAQ,IAAI,MAAM;AAAA,YACpB;AAAA,UAAA,CACD;AAAA,QACH;AAAA,MAAA,OACK;AACLC,sBAAAA,KAAG,UAAU;AAAA,UACX,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU,MAAM;AACd,uBAAW,MAAM;AACfH,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA,cAAA,CACN;AAAA,eACA,GAAI;AAAA,UACT;AAAA,QAAA,CACD;AAAA,MACH;AAAA,IAAA;AAGI,UAAA,aAAa,OAAO,SAAiB;AACzC,YAAM,MAAM,MAAMI,gBAAAA,cAAc,EAAE,KAAY,CAAA;AAC9C,cAAQ,IAAI,GAAG;AACX,UAAA,IAAI,SAAS,KAAK;AACpB,uBAAe,QAAQ,IAAI;AAAA,MAAA,OACtB;AACLJ,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AAAA,MACH;AAAA,IAAA;AAEFK,kBAAAA,UAAU,MAAM;AACN,cAAA,IAAI,MAAM,IAAI;AACtB,iBAAW,MAAM,IAAI;AAAA,IAAA,CACtB;AACDC,kBAAAA,OAAO,MAAM;AACX,iBAAW,MAAM,IAAI;AAAA,IAAA,CACtB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnID,GAAG,gBAAgB,SAAS;"}