{"version":3,"file":"login.js","sources":["../../../../../src/pages/login/login.vue","../../../../../uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<script setup lang=\"ts\">\r\n//\r\nimport {Base64} from 'js-base64'\r\nimport randomWord from '@/utils/random'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport { ref } from 'vue'\r\nimport { logInAPI } from '@/services/logIn'\r\n\r\ntype logInInfo = {\r\n  username: string\r\n  password: string\r\n}\r\n\r\nconst logInInfo = ref<logInInfo>({\r\n  username: '',\r\n  password: '',\r\n})\r\n\r\n// 暂时登录\r\nconst logIn = () => {\r\n  console.log(remPassword.value)\r\n  console.log(logInInfo.value)\r\n  console.log(agree.value)\r\n  if (agree.value) {\r\n    if (logInInfo.value.username == '') {\r\n      uni.showToast({\r\n        title: '用户名不能为空！',\r\n        icon: 'none',\r\n        duration: 1000,\r\n      })\r\n      return\r\n    }\r\n    if (logInInfo.value.password == '') {\r\n      uni.showToast({\r\n        title: '密码不能为空！',\r\n        icon: 'none',\r\n        duration: 1000,\r\n      })\r\n      return\r\n    } else {\r\n      logInAPI({\r\n        username: logInInfo.value.username,\r\n        password: logInInfo.value.password,\r\n      }).then((res) => {\r\n        console.log(logInInfo.value)\r\n        console.log(res)\r\n        if (res.code === 200) {\r\n          uni.showToast({\r\n            title: '登录成功',\r\n            icon: 'success',\r\n            duration: 1000,\r\n          })\r\n          setTimeout(() => {\r\n            uni.switchTab({\r\n              url: '/pages/index/index',\r\n            })\r\n          }, 2000)\r\n          // 存储token\r\n          uni.setStorageSync('token', res.token)\r\n          //存密码\r\n          if (remPassword.value) {\r\n            wx.setStorage({\r\n              key: 'userPass_username',\r\n              data: logInInfo.value.username,\r\n            })\r\n            wx.setStorage({\r\n              key: 'userPass_password',\r\n              data: randomWord(99) + Base64.encode(logInInfo.value.password),\r\n            })\r\n            console.log(randomWord(99) + Base64.encode(logInInfo.value.password))\r\n          }\r\n        } else {\r\n          uni.showToast({\r\n            title: '密码错误',\r\n            icon: 'error',\r\n            duration: 1000,\r\n          })\r\n        }\r\n      })\r\n    }\r\n  } else {\r\n    shakeAnimation()\r\n  }\r\n  // uni.showToast({\r\n  //   title: '登录成功',\r\n  //   icon: 'success',\r\n  //   duration: 1000\r\n  // })\r\n  // setTimeout(() => {\r\n  //   uni.switchTab({\r\n  //     url: '/pages/index/index'\r\n  //   })\r\n  // }, 2000)\r\n}\r\n\r\n// 获取code登陆凭证\r\nlet code = ''\r\nonLoad(async () => {\r\nwx.getStorage({\r\n    key: 'userPass_password',\r\n    success: function (res) {\r\n      console.log(res.data)\r\n      console.log(Base64.decode(res.data.slice(99)))\r\n      logInInfo.value.password = Base64.decode(res.data.slice(99))\r\n    },\r\n    fail: function () {\r\n      logInInfo.value.password = ''\r\n    },\r\n  })\r\n  const res = await wx.login()\r\n  console.log(res)\r\n  code = res.code\r\n  wx.getStorage({\r\n    key: 'userPass_username',\r\n    success: function (res) {\r\n      console.log(res.data)\r\n      logInInfo.value.username = res.data\r\n      remPassword.value=true\r\n    },\r\n    fail: function () {\r\n      logInInfo.value.username = ''\r\n    },\r\n  });\r\n\r\n})\r\n\r\n// 获取用户手机号码\r\nconst onGetphonenumber = (ev: any) => {\r\n  console.log(ev)\r\n}\r\n\r\n//隐私政策\r\nconst agree = ref(false)\r\nconst animation = ref('')\r\n//勾选同意协议\r\nconst agreeChange = () => {\r\n  agree.value = !agree.value\r\n}\r\nconst shakeAnimation = () => {\r\n  console.log('抖动')\r\n  uni.showToast({ title: '请您勾选同意协议', icon: 'none' })\r\n\r\n  animation.value = 'shake'\r\n  setTimeout(() => {\r\n    animation.value = ''\r\n  }, 900)\r\n}\r\n//记住密码\r\nconst remPassword = ref(false)\r\nconst remPasswordChange = () => {\r\n  remPassword.value = !remPassword.value\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n  <view class=\"viewport\">\r\n    <view class=\"logo\">\r\n      <image src=\"../../static/log.png\"></image>\r\n    </view>\r\n    <view class=\"login-content\">\r\n      <uni-easyinput class=\"input\" type=\"text\" v-model=\"logInInfo.username\" placeholder=\"用户名\" />\r\n      <uni-easyinput\r\n        class=\"input\"\r\n        type=\"password\"\r\n        v-model=\"logInInfo.password\"\r\n        placeholder=\"密码\"\r\n      />\r\n    </view>\r\n    <view class=\"login\">\r\n      <button class=\"button phone\" @tap=\"logIn\">\r\n        <text class=\"icon icon-phone\"></text>\r\n        登录/注册\r\n      </button>\r\n      <label class=\"rempass\">\r\n        <checkbox\r\n          value=\"remPassword\"\r\n          :checked=\"remPassword\"\r\n          @click=\"remPasswordChange\"\r\n          color=\"#06afe3\"\r\n          style=\"transform: scale(0.7)\"\r\n        />记住密码\r\n      </label>\r\n      <view class=\"tips\">\r\n        <view class=\"signUp-tip-txt\" :class=\"'animation-' + animation\">\r\n          <checkbox\r\n            class=\"protocol-radio\"\r\n            :checked=\"agree\"\r\n            @click=\"agreeChange\"\r\n            color=\"#3964e6\"\r\n            style=\"\r\n              transform: scale(0.55) translate(45px, 0px);\r\n              width: 73px;\r\n              height: 73px;\r\n              line-height: 73px;\r\n              margin-left: -14%;\r\n            \"\r\n          >\r\n          </checkbox>\r\n          同意\r\n\r\n          <text class=\"signUp-tip-txt-protocol\">《用户协议》</text>\r\n          和\r\n          <text class=\"signUp-tip-txt-protocol\">《隐私政策》</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\npage {\r\n  height: 100%;\r\n}\r\n\r\n.viewport {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n  padding: 20rpx 40rpx;\r\n\r\n  .login-content {\r\n    width: 80%;\r\n    height: 300rpx;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    margin-top: 20rpx;\r\n    .input {\r\n      width: 100%;\r\n    }\r\n  }\r\n}\r\n\r\n.logo {\r\n  flex: 1;\r\n  text-align: center;\r\n  margin-bottom: 60rpx;\r\n  image {\r\n    width: 220rpx;\r\n    height: 220rpx;\r\n    margin-top: 10vh;\r\n  }\r\n}\r\n\r\n.login {\r\n  width: 90%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 60vh;\r\n  padding: 40rpx 20rpx 20rpx;\r\n\r\n  .button {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 100%;\r\n    height: 80rpx;\r\n    font-size: 28rpx;\r\n    border-radius: 72rpx;\r\n    color: #fff;\r\n\r\n    .icon {\r\n      font-size: 40rpx;\r\n      margin-right: 6rpx;\r\n    }\r\n  }\r\n  .rempass {\r\n    display: block;\r\n    margin: 20rpx auto;\r\n    font-size: 24rpx;\r\n    color: #444;\r\n  }\r\n  .phone {\r\n    background-color: #06afe3;\r\n  }\r\n\r\n  .wechat {\r\n    background-color: #06c05f;\r\n\r\n    .options {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      margin-top: 70rpx;\r\n\r\n      button {\r\n        padding: 0;\r\n        background-color: transparent;\r\n      }\r\n    }\r\n\r\n    .icon {\r\n      font-size: 24rpx;\r\n      color: #444;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n\r\n      &::before {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        width: 80rpx;\r\n        height: 80rpx;\r\n        margin-bottom: 6rpx;\r\n        font-size: 40rpx;\r\n        border: 1rpx solid #444;\r\n        border-radius: 50%;\r\n      }\r\n    }\r\n\r\n    .icon-weixin::before {\r\n      border-color: #06c05f;\r\n      color: #06c05f;\r\n    }\r\n  }\r\n}\r\n\r\n.tips {\r\n  position: absolute;\r\n  bottom: 80rpx;\r\n  left: 20rpx;\r\n  right: 20rpx;\r\n  font-size: 23rpx;\r\n  color: #999;\r\n  text-align: center;\r\n}\r\n.signUp-tip-txt-protocol {\r\n  color: red;\r\n}\r\n//勾选协议 抖动动画\r\n.animation-shake {\r\n  animation-delay: 0s;\r\n  animation-duration: 0.1s;\r\n  animation-iteration-count: infinite;\r\n  animation-name: shake;\r\n  animation-play-state: running;\r\n  animation-timing-function: ease-in-out;\r\n}\r\n\r\n@keyframes shake {\r\n  0% {\r\n    transform: translate(0, 0) rotate(0deg);\r\n  }\r\n\r\n  2% {\r\n    transform: translate(-4px, 0) rotate(0deg);\r\n  }\r\n\r\n  4% {\r\n    transform: translate(2px, 0) rotate(0deg);\r\n  }\r\n\r\n  6% {\r\n    transform: translate(-3px, 0) rotate(0deg);\r\n  }\r\n\r\n  8% {\r\n    transform: translate(9px, 0) rotate(0deg);\r\n  }\r\n\r\n  10% {\r\n    transform: translate(2px, 0) rotate(0deg);\r\n  }\r\n\r\n  12% {\r\n    transform: translate(-6px, 0) rotate(0deg);\r\n  }\r\n\r\n  14% {\r\n    transform: translate(-7px, 0) rotate(0deg);\r\n  }\r\n\r\n  16% {\r\n    transform: translate(2px, 0) rotate(0deg);\r\n  }\r\n\r\n  18% {\r\n    transform: translate(7px, 0) rotate(0deg);\r\n  }\r\n\r\n  20% {\r\n    transform: translate(-1px, 0) rotate(0deg);\r\n  }\r\n\r\n  22% {\r\n    transform: translate(-10px, 0) rotate(0deg);\r\n  }\r\n\r\n  24% {\r\n    transform: translate(-10px, 0) rotate(0deg);\r\n  }\r\n\r\n  26% {\r\n    transform: translate(3px, 0) rotate(0deg);\r\n  }\r\n\r\n  28% {\r\n    transform: translate(-5px, 0) rotate(0deg);\r\n  }\r\n\r\n  30% {\r\n    transform: translate(4px, 0) rotate(0deg);\r\n  }\r\n\r\n  32% {\r\n    transform: translate(-6px, 0) rotate(0deg);\r\n  }\r\n\r\n  34% {\r\n    transform: translate(-2px, 0) rotate(0deg);\r\n  }\r\n\r\n  36% {\r\n    transform: translate(-6px, 0) rotate(0deg);\r\n  }\r\n\r\n  38% {\r\n    transform: translate(-2px, 0) rotate(0deg);\r\n  }\r\n\r\n  40% {\r\n    transform: translate(4px, 0) rotate(0deg);\r\n  }\r\n\r\n  42% {\r\n    transform: translate(8px, 0) rotate(0deg);\r\n  }\r\n\r\n  44% {\r\n    transform: translate(-3px, 0) rotate(0deg);\r\n  }\r\n\r\n  46% {\r\n    transform: translate(-10px, 0) rotate(0deg);\r\n  }\r\n\r\n  48% {\r\n    transform: translate(4px, 0) rotate(0deg);\r\n  }\r\n\r\n  50% {\r\n    transform: translate(-6px, 0) rotate(0deg);\r\n  }\r\n\r\n  52% {\r\n    transform: translate(6px, 0) rotate(0deg);\r\n  }\r\n\r\n  54% {\r\n    transform: translate(-8px, 0) rotate(0deg);\r\n  }\r\n\r\n  56% {\r\n    transform: translate(5px, 0) rotate(0deg);\r\n  }\r\n\r\n  58% {\r\n    transform: translate(9px, 0) rotate(0deg);\r\n  }\r\n\r\n  60% {\r\n    transform: translate(7px, 0) rotate(0deg);\r\n  }\r\n\r\n  62% {\r\n    transform: translate(1px, 0) rotate(0deg);\r\n  }\r\n\r\n  64% {\r\n    transform: translate(2px, 0) rotate(0deg);\r\n  }\r\n\r\n  66% {\r\n    transform: translate(-2px, 0) rotate(0deg);\r\n  }\r\n\r\n  68% {\r\n    transform: translate(-7px, 0) rotate(0deg);\r\n  }\r\n\r\n  70% {\r\n    transform: translate(-1px, 0) rotate(0deg);\r\n  }\r\n\r\n  72% {\r\n    transform: translate(-6px, 0) rotate(0deg);\r\n  }\r\n\r\n  74% {\r\n    transform: translate(5px, 0) rotate(0deg);\r\n  }\r\n\r\n  76% {\r\n    transform: translate(0, 0) rotate(0deg);\r\n  }\r\n\r\n  78% {\r\n    transform: translate(9px, 0) rotate(0deg);\r\n  }\r\n\r\n  80% {\r\n    transform: translate(-3px, 0) rotate(0deg);\r\n  }\r\n\r\n  82% {\r\n    transform: translate(8px, 0) rotate(0deg);\r\n  }\r\n\r\n  84% {\r\n    transform: translate(-2px, 0) rotate(0deg);\r\n  }\r\n\r\n  86% {\r\n    transform: translate(-1px, 0) rotate(0deg);\r\n  }\r\n\r\n  88% {\r\n    transform: translate(-3px, 0) rotate(0deg);\r\n  }\r\n\r\n  90% {\r\n    transform: translate(4px, 0) rotate(0deg);\r\n  }\r\n\r\n  92% {\r\n    transform: translate(0, 0) rotate(0deg);\r\n  }\r\n\r\n  94% {\r\n    transform: translate(4px, 0) rotate(0deg);\r\n  }\r\n\r\n  96% {\r\n    transform: translate(2px, 0) rotate(0deg);\r\n  }\r\n\r\n  98% {\r\n    transform: translate(-2px, 0) rotate(0deg);\r\n  }\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/feidian/计算机设计大赛/xswc_cs/src/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","logInAPI","wx","randomWord","Base64","onLoad","res"],"mappings":"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"}