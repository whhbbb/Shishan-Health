{"version":3,"file":"login.js","sources":["../../../../../src/pages/login/login.vue","../../../../../uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<script setup lang=\"ts\">\n//\nimport {Base64} from 'js-base64'\nimport randomWord from '@/utils/random'\nimport { onLoad } from '@dcloudio/uni-app'\nimport { ref } from 'vue'\nimport { logInAPI } from '@/services/logIn'\n\ntype logInInfo = {\n  username: string\n  password: string\n}\n\nconst logInInfo = ref<logInInfo>({\n  username: '',\n  password: '',\n})\n\n// 暂时登录\nconst logIn = () => {\n  console.log(remPassword.value)\n  console.log(logInInfo.value)\n  console.log(agree.value)\n  if (agree.value) {\n    if (logInInfo.value.username == '') {\n      uni.showToast({\n        title: '用户名不能为空！',\n        icon: 'none',\n        duration: 1000,\n      })\n      return\n    }\n    if (logInInfo.value.password == '') {\n      uni.showToast({\n        title: '密码不能为空！',\n        icon: 'none',\n        duration: 1000,\n      })\n      return\n    } else {\n      logInAPI({\n        username: logInInfo.value.username,\n        password: logInInfo.value.password,\n      }).then((res) => {\n        console.log(logInInfo.value)\n        console.log(res)\n        if (res.code === 200) {\n          uni.showToast({\n            title: '登录成功',\n            icon: 'success',\n            duration: 1000,\n          })\n          setTimeout(() => {\n            uni.switchTab({\n              url: '/pages/index/index',\n            })\n          }, 2000)\n          // 存储token\n          uni.setStorageSync('token', res.token)\n          //存密码\n          if (remPassword.value) {\n            wx.setStorage({\n              key: 'userPass_username',\n              data: logInInfo.value.username,\n            })\n            wx.setStorage({\n              key: 'userPass_password',\n              data: randomWord(99) + Base64.encode(logInInfo.value.password),\n            })\n            console.log(randomWord(99) + Base64.encode(logInInfo.value.password))\n          }\n        } else {\n          uni.showToast({\n            title: '密码错误',\n            icon: 'error',\n            duration: 1000,\n          })\n        }\n      })\n    }\n  } else {\n    shakeAnimation()\n  }\n  // uni.showToast({\n  //   title: '登录成功',\n  //   icon: 'success',\n  //   duration: 1000\n  // })\n  // setTimeout(() => {\n  //   uni.switchTab({\n  //     url: '/pages/index/index'\n  //   })\n  // }, 2000)\n}\n\n// 获取code登陆凭证\nlet code = ''\nonLoad(async () => {\nwx.getStorage({\n    key: 'userPass_password',\n    success: function (res) {\n      console.log(res.data)\n      console.log(Base64.decode(res.data.slice(99)))\n      logInInfo.value.password = Base64.decode(res.data.slice(99))\n    },\n    fail: function () {\n      logInInfo.value.password = ''\n    },\n  })\n  const res = await wx.login()\n  console.log(res)\n  code = res.code\n  wx.getStorage({\n    key: 'userPass_username',\n    success: function (res) {\n      console.log(res.data)\n      logInInfo.value.username = res.data\n      remPassword.value=true\n    },\n    fail: function () {\n      logInInfo.value.username = ''\n    },\n  });\n\n})\n\n// 获取用户手机号码\nconst onGetphonenumber = (ev: any) => {\n  console.log(ev)\n}\n\n//隐私政策\nconst agree = ref(false)\nconst animation = ref('')\n//勾选同意协议\nconst agreeChange = () => {\n  agree.value = !agree.value\n}\nconst shakeAnimation = () => {\n  console.log('抖动')\n  uni.showToast({ title: '请您勾选同意协议', icon: 'none' })\n\n  animation.value = 'shake'\n  setTimeout(() => {\n    animation.value = ''\n  }, 900)\n}\n//记住密码\nconst remPassword = ref(false)\nconst remPasswordChange = () => {\n  remPassword.value = !remPassword.value\n}\n\n</script>\n\n<template>\n  <view class=\"viewport\">\n    <view class=\"logo\">\n      <image src=\"../../static/log.png\"></image>\n    </view>\n    <view class=\"login-content\">\n      <uni-easyinput class=\"input\" type=\"text\" v-model=\"logInInfo.username\" placeholder=\"用户名\" />\n      <uni-easyinput\n        class=\"input\"\n        type=\"password\"\n        v-model=\"logInInfo.password\"\n        placeholder=\"密码\"\n      />\n    </view>\n    <view class=\"login\">\n      <button class=\"button phone\" @tap=\"logIn\">\n        <text class=\"icon icon-phone\"></text>\n        登录/注册\n      </button>\n      <label class=\"rempass\">\n        <checkbox\n          value=\"remPassword\"\n          :checked=\"remPassword\"\n          @click=\"remPasswordChange\"\n          color=\"#06afe3\"\n          style=\"transform: scale(0.7)\"\n        />记住密码\n      </label>\n      <view class=\"tips\">\n        <view class=\"signUp-tip-txt\" :class=\"'animation-' + animation\">\n          <checkbox\n            class=\"protocol-radio\"\n            :checked=\"agree\"\n            @click=\"agreeChange\"\n            color=\"#3964e6\"\n            style=\"\n              transform: scale(0.55) translate(45px, 0px);\n              width: 73px;\n              height: 73px;\n              line-height: 73px;\n              margin-left: -14%;\n            \"\n          >\n          </checkbox>\n          同意\n\n          <text class=\"signUp-tip-txt-protocol\">《用户协议》</text>\n          和\n          <text class=\"signUp-tip-txt-protocol\">《隐私政策》</text>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<style lang=\"scss\">\npage {\n  height: 100%;\n}\n\n.viewport {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  padding: 20rpx 40rpx;\n\n  .login-content {\n    width: 80%;\n    height: 300rpx;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    margin-top: 20rpx;\n    .input {\n      width: 100%;\n    }\n  }\n}\n\n.logo {\n  flex: 1;\n  text-align: center;\n  margin-bottom: 60rpx;\n  image {\n    width: 220rpx;\n    height: 220rpx;\n    margin-top: 10vh;\n  }\n}\n\n.login {\n  width: 90%;\n  display: flex;\n  flex-direction: column;\n  height: 60vh;\n  padding: 40rpx 20rpx 20rpx;\n\n  .button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    height: 80rpx;\n    font-size: 28rpx;\n    border-radius: 72rpx;\n    color: #fff;\n\n    .icon {\n      font-size: 40rpx;\n      margin-right: 6rpx;\n    }\n  }\n  .rempass {\n    display: block;\n    margin: 20rpx auto;\n    font-size: 24rpx;\n    color: #444;\n  }\n  .phone {\n    background-color: #06afe3;\n  }\n\n  .wechat {\n    background-color: #06c05f;\n\n    .options {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      margin-top: 70rpx;\n\n      button {\n        padding: 0;\n        background-color: transparent;\n      }\n    }\n\n    .icon {\n      font-size: 24rpx;\n      color: #444;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n\n      &::before {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 80rpx;\n        height: 80rpx;\n        margin-bottom: 6rpx;\n        font-size: 40rpx;\n        border: 1rpx solid #444;\n        border-radius: 50%;\n      }\n    }\n\n    .icon-weixin::before {\n      border-color: #06c05f;\n      color: #06c05f;\n    }\n  }\n}\n\n.tips {\n  position: absolute;\n  bottom: 80rpx;\n  left: 20rpx;\n  right: 20rpx;\n  font-size: 23rpx;\n  color: #999;\n  text-align: center;\n}\n.signUp-tip-txt-protocol {\n  color: red;\n}\n//勾选协议 抖动动画\n.animation-shake {\n  animation-delay: 0s;\n  animation-duration: 0.1s;\n  animation-iteration-count: infinite;\n  animation-name: shake;\n  animation-play-state: running;\n  animation-timing-function: ease-in-out;\n}\n\n@keyframes shake {\n  0% {\n    transform: translate(0, 0) rotate(0deg);\n  }\n\n  2% {\n    transform: translate(-4px, 0) rotate(0deg);\n  }\n\n  4% {\n    transform: translate(2px, 0) rotate(0deg);\n  }\n\n  6% {\n    transform: translate(-3px, 0) rotate(0deg);\n  }\n\n  8% {\n    transform: translate(9px, 0) rotate(0deg);\n  }\n\n  10% {\n    transform: translate(2px, 0) rotate(0deg);\n  }\n\n  12% {\n    transform: translate(-6px, 0) rotate(0deg);\n  }\n\n  14% {\n    transform: translate(-7px, 0) rotate(0deg);\n  }\n\n  16% {\n    transform: translate(2px, 0) rotate(0deg);\n  }\n\n  18% {\n    transform: translate(7px, 0) rotate(0deg);\n  }\n\n  20% {\n    transform: translate(-1px, 0) rotate(0deg);\n  }\n\n  22% {\n    transform: translate(-10px, 0) rotate(0deg);\n  }\n\n  24% {\n    transform: translate(-10px, 0) rotate(0deg);\n  }\n\n  26% {\n    transform: translate(3px, 0) rotate(0deg);\n  }\n\n  28% {\n    transform: translate(-5px, 0) rotate(0deg);\n  }\n\n  30% {\n    transform: translate(4px, 0) rotate(0deg);\n  }\n\n  32% {\n    transform: translate(-6px, 0) rotate(0deg);\n  }\n\n  34% {\n    transform: translate(-2px, 0) rotate(0deg);\n  }\n\n  36% {\n    transform: translate(-6px, 0) rotate(0deg);\n  }\n\n  38% {\n    transform: translate(-2px, 0) rotate(0deg);\n  }\n\n  40% {\n    transform: translate(4px, 0) rotate(0deg);\n  }\n\n  42% {\n    transform: translate(8px, 0) rotate(0deg);\n  }\n\n  44% {\n    transform: translate(-3px, 0) rotate(0deg);\n  }\n\n  46% {\n    transform: translate(-10px, 0) rotate(0deg);\n  }\n\n  48% {\n    transform: translate(4px, 0) rotate(0deg);\n  }\n\n  50% {\n    transform: translate(-6px, 0) rotate(0deg);\n  }\n\n  52% {\n    transform: translate(6px, 0) rotate(0deg);\n  }\n\n  54% {\n    transform: translate(-8px, 0) rotate(0deg);\n  }\n\n  56% {\n    transform: translate(5px, 0) rotate(0deg);\n  }\n\n  58% {\n    transform: translate(9px, 0) rotate(0deg);\n  }\n\n  60% {\n    transform: translate(7px, 0) rotate(0deg);\n  }\n\n  62% {\n    transform: translate(1px, 0) rotate(0deg);\n  }\n\n  64% {\n    transform: translate(2px, 0) rotate(0deg);\n  }\n\n  66% {\n    transform: translate(-2px, 0) rotate(0deg);\n  }\n\n  68% {\n    transform: translate(-7px, 0) rotate(0deg);\n  }\n\n  70% {\n    transform: translate(-1px, 0) rotate(0deg);\n  }\n\n  72% {\n    transform: translate(-6px, 0) rotate(0deg);\n  }\n\n  74% {\n    transform: translate(5px, 0) rotate(0deg);\n  }\n\n  76% {\n    transform: translate(0, 0) rotate(0deg);\n  }\n\n  78% {\n    transform: translate(9px, 0) rotate(0deg);\n  }\n\n  80% {\n    transform: translate(-3px, 0) rotate(0deg);\n  }\n\n  82% {\n    transform: translate(8px, 0) rotate(0deg);\n  }\n\n  84% {\n    transform: translate(-2px, 0) rotate(0deg);\n  }\n\n  86% {\n    transform: translate(-1px, 0) rotate(0deg);\n  }\n\n  88% {\n    transform: translate(-3px, 0) rotate(0deg);\n  }\n\n  90% {\n    transform: translate(4px, 0) rotate(0deg);\n  }\n\n  92% {\n    transform: translate(0, 0) rotate(0deg);\n  }\n\n  94% {\n    transform: translate(4px, 0) rotate(0deg);\n  }\n\n  96% {\n    transform: translate(2px, 0) rotate(0deg);\n  }\n\n  98% {\n    transform: translate(-2px, 0) rotate(0deg);\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/whhbbb/Documents/Project-storage/xswc_game/src/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","logInAPI","wx","randomWord","Base64","onLoad","res"],"mappings":"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"}