{"version":3,"file":"ActivityDetails.js","sources":["../../../../../src/pages/activity/ActivityDetails.vue","../../../../../uniPage:/cGFnZXMvYWN0aXZpdHkvQWN0aXZpdHlEZXRhaWxzLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"detail\">\n    <view class=\"top\">\n      <view class=\"detail-title\">\n        {{ data0.userImg2 }}\n      </view>\n      <view class=\"detail-content\">\n        <view class=\"status\">\n          {{ data0.isEnd }}\n        </view>\n        <view class=\"population\">\n          <image class=\"img\" src=\"../../static/activity/User.png\" />{{ data0.hbNum }}/{{\n            data0.hot\n          }}\n        </view>\n        <view class=\"detail-class\">\n          <uni-tag v-if=\"data0.sort == 1\" type=\"primary\" text=\"学术晚茶\" />\n          <uni-tag v-else type=\"success\" text=\"学术社区\" />\n        </view>\n      </view>\n    </view>\n    <view class=\"middle\">\n      <view class=\"sponsor\"> 发起学院：{{ data0.hbKeyword }} </view>\n      <view class=\"time\">\n        <image class=\"img\" src=\"../../static/activity/clock.png\" />{{ data0.lat }}\n      </view>\n      <view class=\"address\">\n        <image class=\"img\" src=\"../../static/activity/address.png\" />{{ data0.address }}\n      </view>\n      <view class=\"address\">\n        <image class=\"img\" src=\"../../static/activity/address.png\" />线上地址：{{\n          data0.cityname == '' ? '无' : data0.cityname\n        }}\n      </view>\n    </view>\n    <view class=\"bottom\">\n      <view class=\"sponsor-intro\">\n        <view class=\"title\"> 主讲人简介： </view>\n        <view class=\"intro\">\n          {{ data0.img }}\n        </view>\n      </view>\n      <view class=\"activity-intro\">\n        <view class=\"title\"> 活动简介： </view>\n        <view class=\"intro\">\n          {{ data0.details }}\n        </view>\n      </view>\n    </view>\n    <view class=\"footer\">\n      <view class=\"activity-btn\">\n        <div class=\"btn hhh\" v-if=\"data0.isClose === 0\">\n          <button type=\"default\" class=\"hhh-btn\">报名未开始</button>\n          <span class=\"span\">报名开始时间为：{{ data0.startTime }}</span>\n        </div>\n        <button\n          type=\"primary\"\n          v-else-if=\"data0.isApplication.length === 0 && data0.isClose === 1\"\n          class=\"btn\"\n          @click=\"applyon\"\n        >\n          报名\n        </button>\n        <button\n          type=\"default\"\n          v-else-if=\"data0.isApplication.length > 0 && data0.isClose === 1\"\n          class=\"btn\"\n        >\n          已报名\n        </button>\n        <button type=\"default\" v-else class=\"btn\">报名截止</button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"ts\">\nimport { http } from '../../utils/http'\nimport { ref, reactive } from 'vue'\nimport { onHide, onLoad } from '@dcloudio/uni-app'\ntype DataProps = {\n  id: number\n  userImg2: string\n  isEnd: string\n  isClose: number\n  hbNum: number\n  hot: number\n  hbKeyword: string\n  lat: string\n  address: string\n  img: string\n  details: string\n  isApplication: Array<any>\n  is_close: number\n  startTime: string\n  sort: number\n  cityname: string\n}\n\nconst data0 = ref<DataProps>()\nconst props = defineProps<{\n  id: number\n}>()\nlet AId=props.id;\nconst getDetailsAPI = (data: any) => {\n  return http<any>({\n    url: data,\n    method: 'GET',\n  })\n}\nconst applyAPI = (data: any) => {\n  return http<any>({\n    method: 'POST',\n    url: '/system/useractivity',\n    data,\n  })\n}\nconst getDetails = async (url: string) => {\n  uni.showLoading({\n    title: '加载中',\n  })\n  const res = await getDetailsAPI(url)\n  uni.hideLoading()\n  console.log(res)\n  data0.value = res.data\n  data0.value.isEnd = res.data.isEnd == 1 ? '进行中' : '已结束'\n  data0.value.isApplication = res.data.isApplication === null ? [] : res.data.isApplication\n}\nconst apply = async (data: any) => {\n  const res = await applyAPI(data)\n  if (res.code === 200) {\n    wx.showToast({\n      title: res.msg,\n      icon: 'success',\n      duration: 2000,\n      success: () => {\n        setTimeout(() => {\n          uni.switchTab({\n            url: '/pages/index/index',\n          })\n        }, 2000)\n      },\n    })\n    data0.value.is_close = 1\n  } else {\n    wx.showToast({\n      title: res.msg,\n      icon: 'none',\n      duration: 2000,\n    })\n  }\n}\n\nonLoad(async (options) => {\n  let obj = wx.getLaunchOptionsSync()\n  let query = null\n  let url = `/system/activity/${props.id}`\n  console.log(props.id+\"11111\")\n  if (options.scene || obj.query.scene) {\n    console.log('options.scene', options)\n    console.log('obj.query.scene', obj.query)\n    // 这里是用开发者工具模拟的时候要先用 encodeURIComponent 编译，模拟真实传递参数的效果，项目发布审核的时候这句话要注释掉\n    // query = options ? encodeURIComponent(options.scene) : encodeURIComponent(obj.query.scene);\n    query = options ? decodeURIComponent(options.scene) : decodeURIComponent(obj.query.scene)\n    console.log(query)\n    AId=query;\n    url = `/system/activity/${query}`\n  }\n  getDetails(url)\n})\nonHide(() => {})\n//报名函数\nconst applyon = () => {\n  if (uni.getStorageSync('token')) {\n    wx.showModal({\n      title: '确认报名',\n      content: '确定要报名吗？',\n      success(res) {\n        if (res.confirm) {\n          //用户点击了确认按钮\n          apply({\n            activityId: AId,\n          })\n          const url = `/system/activity/${AId}`\n          getDetails(url)\n        } else if (res.cancel) {\n          // 用户点击了取消按钮\n          console.log('用户取消了报名')\n        }\n      },\n    })\n  } else {\n    wx.showToast({\n      title: '您尚未登录，请先登录',\n      icon: 'none',\n      duration: 1000,\n      complete: () => {\n        setTimeout(() => {\n          uni.navigateTo({\n            url: '/pages/login/login',\n          })\n        }, 1000)\n      },\n    })\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.detail {\n  // overflow-y: scroll;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 90%;\n  margin: 0 auto;\n\n  .top {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    margin-bottom: 20rpx;\n\n    .detail-title {\n      font-size: 44rpx;\n      // font-weight: bold;\n      margin: 10rpx 0 0 10rpx;\n      margin-bottom: 15rpx;\n    }\n\n    .detail-content {\n      display: flex;\n      justify-content: space-between;\n      margin: 0 10rpx 10rpx 10rpx;\n\n      .status {\n        font-size: 30rpx;\n        color: #ff0000;\n\n        .img {\n          width: 30rpx;\n          height: 30rpx;\n          margin-right: 10rpx;\n        }\n      }\n\n      .population {\n        font-size: 30rpx;\n        color: #000000;\n\n        .img {\n          width: 30rpx;\n          height: 30rpx;\n          margin-right: 10rpx;\n        }\n      }\n    }\n  }\n\n  .middle {\n    height: 500rpx;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n    margin-bottom: 60rpx;\n\n    .sponsor {\n      flex: 1;\n      display: flex;\n      align-items: center;\n      font-size: 30rpx;\n      color: #000000;\n      border-bottom: 1px solid #d6d6d6;\n    }\n\n    .time {\n      font-size: 30rpx;\n      color: #000000;\n      flex: 1;\n      display: flex;\n      align-items: center;\n      border-bottom: 1px solid #d6d6d6;\n\n      .img {\n        width: 30rpx;\n        height: 30rpx;\n        margin-right: 10rpx;\n      }\n    }\n\n    .address {\n      font-size: 30rpx;\n      color: #000000;\n      flex: 1;\n      display: flex;\n      align-items: center;\n      border-bottom: 1px solid #d6d6d6;\n\n      .img {\n        width: 30rpx;\n        height: 30rpx;\n        margin-right: 10rpx;\n      }\n    }\n  }\n\n  .bottom {\n    flex: 1;\n\n    .sponsor-intro {\n      margin-bottom: 80rpx;\n\n      .title {\n        font-size: 30rpx;\n        color: grey;\n        margin-bottom: 10rpx;\n      }\n\n      .intro {\n        font-size: 30rpx;\n        color: #000000;\n      }\n    }\n\n    .activity-intro {\n      .title {\n        font-size: 30rpx;\n        color: grey;\n        margin-bottom: 10rpx;\n      }\n\n      .intro {\n        font-size: 30rpx;\n        color: #000000;\n      }\n    }\n  }\n\n  .footer {\n    .activity-btn {\n      margin-bottom: 45rpx;\n      display: flex;\n      justify-content: center;\n\n      .btn {\n        width: 40%;\n        margin-top: 50rpx;\n        font-size: 38rpx;\n      }\n      .hhh {\n        width: 100%;\n        display: flex;\n        flex-direction: column;\n        align-content: center;\n        .hhh-btn {\n          width: 40%;\n          margin-bottom: 10rpx;\n        }\n        .span {\n          text-align: center;\n          color: #6b6a6a;\n          font-size: 15px;\n          // margin-bottom: 10rpx;\n        }\n      }\n    }\n  }\n}\n\n.code-view {\n  margin: 20rpx auto;\n  padding-bottom: 30rpx;\n}\n</style>\n","import MiniProgramPage from '/Users/whhbbb/Documents/Project-storage/xswc_game/src/pages/activity/ActivityDetails.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","http","uni","wx","onLoad","onHide"],"mappings":"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"}