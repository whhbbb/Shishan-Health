{"version":3,"file":"ActivitySignIn.js","sources":["../../../../../src/pages/activity/ActivitySignIn.vue","../../../../../uniPage:/cGFnZXMvYWN0aXZpdHkvQWN0aXZpdHlTaWduSW4udnVl"],"sourcesContent":["<template>\r\n  <div>\r\n    <image @click=\"scan()\" class=\"scan-img\" src=\"../../static/activity/scanimg.png\"></image>\r\n    <button style=\"box-shadow: 0 0 7px rgba(0, 0, 0, 0.1)\" type=\"primary\" @click=\"scan()\" id=\"scan\">\r\n      扫一扫\r\n    </button>\r\n\r\n    <!-- <button type=\"primary\" @click=\"qrsigncode()\" id=\"token\">签到码</button> -->\r\n    <!-- <button type=\"primary\" @click=\"qrapplycode()\" id=\"token\">报名码</button> -->\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { onLoad } from '@dcloudio/uni-app'\r\n\r\n// 获取报名码函数\r\n// qrapplycode(){\r\n//   //获取appid和appsecret\r\n//   wx.request({\r\n//     method:'GET',\r\n//     url:'http://117.50.163.249:3166/system/app',\r\n//     header:{\r\n//       'Authorization':'Bearer eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6IjAwNjhiMzY4LTk2MTctNDhhMi05NGM3LWRhMDRlM2YxYTgzMyJ9.NRPuqh96eIsA11EgkRNVsnpZAGclIvE0EvdjCKhi3BOFVf94XOaEUFlw57jLQRyRpFkz_UALDIUNNtTRAlbumw'\r\n//     },\r\n//     success(res) {\r\n//       const appid=res.data.data.appid\r\n//       const appsecret=res.data.data.appsecret\r\n//       //获取access_token\r\n//        wx.request({\r\n//        method:'POST',\r\n//        url:'https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid='+appid+'&secret='+appsecret,\r\n//        success(res) {\r\n//          console.log(res.data.access_token)\r\n//          //获取报名码\r\n//   wx.request({\r\n//        url:'https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token='+res.data.access_token,\r\n//        method:'POST',\r\n//        data:{\r\n//          \"page\": \"pages/activity/ActivityDetails\",\r\n//           \"scene\": \"id=2210\",//activityid\r\n//           \"check_path\": false,\r\n//           \"env_version\": \"release\"\r\n//        },\r\n//        success(res){\r\n//          //将二进制的图片格式转换\r\n//         const base64 = wx.arrayBufferToBase64(res.data);\r\n//         const imgurl = 'data:image/jpeg;base64,' + base64;\r\n//        }\r\n//      })\r\n//        }\r\n//      })\r\n//     }\r\n//   })\r\n\r\n// },\r\n\r\nconst scan = () => {\r\n  uni.scanCode({\r\n    success: (res) => {\r\n      //判断当前手机系统\r\n      // wx.getSystemInfo({\r\n      //   success: (res22) => {\r\n      console.log(res)\r\n      console.log('res.path', res.path) //pages/me/me?scene=table_id%3D8%26shop_id%3D1\r\n      // const platform = res22.platform.toLowerCase()\r\n      var path = res.path\r\n      // 判断当前手机系统\r\n      // if (platform.includes('ios')) {\r\n      //   console.log('当前手机系统为 iOS')\r\n      //   path = decodeURIComponent(path)\r\n      //   console.log(path)\r\n      // }\r\n      const modifiedStr = path.replace('?scene=', '?id=')\r\n      console.log(modifiedStr)\r\n      uni.navigateTo({\r\n        url: '/' + modifiedStr,\r\n      })\r\n\r\n      // else if (platform.includes('windows')) {\r\n      //   console.log('当前手机系统为 Windows Phone');\r\n      // } else {\r\n      //   console.log('当前手机系统为其他');\r\n      // }\r\n      //   },\r\n      // })\r\n\r\n      //微信开发者工具 在开发者工具里出现乱码需要decodeURIComponent转义,真机不需要,可以直接使用\r\n    },\r\n  })\r\n}\r\nonLoad(() => {\r\n  if (!uni.getStorageSync('token')) {\r\n    uni.showToast({\r\n      title: '请先登录',\r\n      icon: 'none',\r\n      duration: 1000,\r\n      complete: (res) => {\r\n        setTimeout(() => {\r\n          uni.navigateTo({\r\n            url: '/pages/login/login',\r\n          })\r\n        }, 1000)\r\n      },\r\n    })\r\n  }\r\n})\r\n// 获取签到码\r\n//  qrsigncode(){\r\n//    wx.request({\r\n//      method:'GET',\r\n//      url:'http://117.50.163.249:3166/system/app',\r\n//      header:{\r\n//        'Authorization':`Bearer ${uni.getStorageSync('token')}`\r\n//      },\r\n//      success(res) {\r\n//    wx.request({\r\n//      method:'POST',\r\n//      url:'https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid='+appId+'&secret='+appsecret,\r\n//      success(res) {\r\n//        console.log(res)\r\n//        console.log(res.data.access_token)\r\n// wx.request({\r\n//      url:'https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token='+res.data.access_token,\r\n//      method:'POST',\r\n//      data:{\r\n//        \"page\": \"pages/activity/SignCheck\",\r\n//         \"scene\": \"id=2210\",\r\n//         \"check_path\": false,\r\n//         \"env_version\": \"release\"\r\n//      },\r\n//      success(res){\r\n//        console.log(res)\r\n//       const base64 = wx.arrayBufferToBase64(res.data);\r\n//       const imgurl = 'data:image/jpeg;base64,' + base64;\r\n\r\n//      }\r\n//    })\r\n//      }\r\n//    })\r\n//    }})\r\n//  },\r\n</script>\r\n<style scoped>\r\n.scan-img {\r\n  width: 70%;\r\n  height: 500rpx;\r\n\r\n  margin: 5vh 15%;\r\n  /* border: 1rpx solid #ccc; */\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\nbutton {\r\n  width: 80%;\r\n  margin: 1vh 10%;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/feidian/计算机设计大赛/xswc_cs/src/pages/activity/ActivitySignIn.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","onLoad"],"mappings":";;;;;AAwDA,UAAM,OAAO,MAAM;AACjBA,oBAAAA,MAAI,SAAS;AAAA,QACX,SAAS,CAAC,QAAQ;AAIhB,kBAAQ,IAAI,GAAG;AACP,kBAAA,IAAI,YAAY,IAAI,IAAI;AAEhC,cAAI,OAAO,IAAI;AAOf,gBAAM,cAAc,KAAK,QAAQ,WAAW,MAAM;AAClD,kBAAQ,IAAI,WAAW;AACvBA,wBAAAA,MAAI,WAAW;AAAA,YACb,KAAK,MAAM;AAAA,UAAA,CACZ;AAAA,QAWH;AAAA,MAAA,CACD;AAAA,IAAA;AAEHC,kBAAAA,OAAO,MAAM;AACX,UAAI,CAACD,cAAA,MAAI,eAAe,OAAO,GAAG;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU,CAAC,QAAQ;AACjB,uBAAW,MAAM;AACfA,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA,cAAA,CACN;AAAA,eACA,GAAI;AAAA,UACT;AAAA,QAAA,CACD;AAAA,MACH;AAAA,IAAA,CACD;;;;;;;;;;ACxGD,GAAG,WAAW,eAAe;"}