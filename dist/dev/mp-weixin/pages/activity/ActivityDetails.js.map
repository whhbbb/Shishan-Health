{"version":3,"file":"ActivityDetails.js","sources":["../../../../../src/pages/activity/ActivityDetails.vue","../../../../../uniPage:/cGFnZXMvYWN0aXZpdHkvQWN0aXZpdHlEZXRhaWxzLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"detail\">\r\n    <view class=\"top\">\r\n      <view class=\"detail-title\">\r\n        {{ data0.userImg2 }}\r\n      </view>\r\n      <view class=\"detail-content\">\r\n        <view class=\"status\">\r\n          {{ data0.isEnd }}\r\n        </view>\r\n        <view class=\"population\">\r\n          <image class=\"img\" src=\"../../static/activity/User.png\" />{{ data0.hbNum }}/{{\r\n            data0.hot\r\n          }}\r\n        </view>\r\n        <view class=\"detail-class\">\r\n          <uni-tag v-if=\"data0.sort == 1\" type=\"primary\" text=\"学术晚茶\" />\r\n          <uni-tag v-else type=\"success\" text=\"学术社区\" />\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <view class=\"middle\">\r\n      <view class=\"sponsor\"> 发起学院：{{ data0.hbKeyword }} </view>\r\n      <view class=\"time\">\r\n        <image class=\"img\" src=\"../../static/activity/clock.png\" />{{ data0.lat }}\r\n      </view>\r\n      <view class=\"address\">\r\n        <image class=\"img\" src=\"../../static/activity/address.png\" />{{ data0.address }}\r\n      </view>\r\n      <view class=\"address\">\r\n        <image class=\"img\" src=\"../../static/activity/address.png\" />线上地址：{{\r\n          data0.cityname == '' ? '无' : data0.cityname\r\n        }}\r\n      </view>\r\n    </view>\r\n    <view class=\"bottom\">\r\n      <view class=\"sponsor-intro\">\r\n        <view class=\"title\"> 主讲人简介： </view>\r\n        <view class=\"intro\">\r\n          {{ data0.img }}\r\n        </view>\r\n      </view>\r\n      <view class=\"activity-intro\">\r\n        <view class=\"title\"> 活动简介： </view>\r\n        <view class=\"intro\">\r\n          {{ data0.details }}\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <view class=\"footer\">\r\n      <view class=\"activity-btn\">\r\n        <div class=\"btn hhh\" v-if=\"data0.isClose === 0\">\r\n          <button type=\"default\" class=\"hhh-btn\">报名未开始</button>\r\n          <span class=\"span\">报名开始时间为：{{ data0.startTime }}</span>\r\n        </div>\r\n        <button\r\n          type=\"primary\"\r\n          v-else-if=\"data0.isApplication.length === 0 && data0.isClose === 1\"\r\n          class=\"btn\"\r\n          @click=\"applyon\"\r\n        >\r\n          报名\r\n        </button>\r\n        <button\r\n          type=\"default\"\r\n          v-else-if=\"data0.isApplication.length > 0 && data0.isClose === 1\"\r\n          class=\"btn\"\r\n        >\r\n          已报名\r\n        </button>\r\n        <button type=\"default\" v-else class=\"btn\">报名截止</button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { http } from '../../utils/http'\r\nimport { ref, reactive } from 'vue'\r\nimport { onHide, onLoad } from '@dcloudio/uni-app'\r\ntype DataProps = {\r\n  id: number\r\n  userImg2: string\r\n  isEnd: string\r\n  isClose: number\r\n  hbNum: number\r\n  hot: number\r\n  hbKeyword: string\r\n  lat: string\r\n  address: string\r\n  img: string\r\n  details: string\r\n  isApplication: Array<any>\r\n  is_close: number\r\n  startTime: string\r\n  sort: number\r\n  cityname: string\r\n}\r\n\r\nconst data0 = ref<DataProps>()\r\nconst props = defineProps<{\r\n  id: number\r\n}>()\r\nlet AId=props.id;\r\nconst getDetailsAPI = (data: any) => {\r\n  return http<any>({\r\n    url: data,\r\n    method: 'GET',\r\n  })\r\n}\r\nconst applyAPI = (data: any) => {\r\n  return http<any>({\r\n    method: 'POST',\r\n    url: '/system/useractivity',\r\n    data,\r\n  })\r\n}\r\nconst getDetails = async (url: string) => {\r\n  uni.showLoading({\r\n    title: '加载中',\r\n  })\r\n  const res = await getDetailsAPI(url)\r\n  uni.hideLoading()\r\n  console.log(res)\r\n  data0.value = res.data\r\n  data0.value.isEnd = res.data.isEnd == 1 ? '进行中' : '已结束'\r\n  data0.value.isApplication = res.data.isApplication === null ? [] : res.data.isApplication\r\n}\r\nconst apply = async (data: any) => {\r\n  const res = await applyAPI(data)\r\n  if (res.code === 200) {\r\n    wx.showToast({\r\n      title: res.msg,\r\n      icon: 'success',\r\n      duration: 2000,\r\n      success: () => {\r\n        setTimeout(() => {\r\n          uni.switchTab({\r\n            url: '/pages/index/index',\r\n          })\r\n        }, 2000)\r\n      },\r\n    })\r\n    data0.value.is_close = 1\r\n  } else {\r\n    wx.showToast({\r\n      title: res.msg,\r\n      icon: 'none',\r\n      duration: 2000,\r\n    })\r\n  }\r\n}\r\n\r\nonLoad(async (options) => {\r\n  let obj = wx.getLaunchOptionsSync()\r\n  let query = null\r\n  let url = `/system/activity/${props.id}`\r\n  console.log(props.id+\"11111\")\r\n  if (options.scene || obj.query.scene) {\r\n    console.log('options.scene', options)\r\n    console.log('obj.query.scene', obj.query)\r\n    // 这里是用开发者工具模拟的时候要先用 encodeURIComponent 编译，模拟真实传递参数的效果，项目发布审核的时候这句话要注释掉\r\n    // query = options ? encodeURIComponent(options.scene) : encodeURIComponent(obj.query.scene);\r\n    query = options ? decodeURIComponent(options.scene) : decodeURIComponent(obj.query.scene)\r\n    console.log(query)\r\n    AId=query;\r\n    url = `/system/activity/${query}`\r\n  }\r\n  getDetails(url)\r\n})\r\nonHide(() => {})\r\n//报名函数\r\nconst applyon = () => {\r\n  if (uni.getStorageSync('token')) {\r\n    wx.showModal({\r\n      title: '确认报名',\r\n      content: '确定要报名吗？',\r\n      success(res) {\r\n        if (res.confirm) {\r\n          //用户点击了确认按钮\r\n          apply({\r\n            activityId: AId,\r\n          })\r\n          const url = `/system/activity/${AId}`\r\n          getDetails(url)\r\n        } else if (res.cancel) {\r\n          // 用户点击了取消按钮\r\n          console.log('用户取消了报名')\r\n        }\r\n      },\r\n    })\r\n  } else {\r\n    wx.showToast({\r\n      title: '您尚未登录，请先登录',\r\n      icon: 'none',\r\n      duration: 1000,\r\n      complete: () => {\r\n        setTimeout(() => {\r\n          uni.navigateTo({\r\n            url: '/pages/login/login',\r\n          })\r\n        }, 1000)\r\n      },\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.detail {\r\n  // overflow-y: scroll;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  width: 90%;\r\n  margin: 0 auto;\r\n\r\n  .top {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    margin-bottom: 20rpx;\r\n\r\n    .detail-title {\r\n      font-size: 44rpx;\r\n      // font-weight: bold;\r\n      margin: 10rpx 0 0 10rpx;\r\n      margin-bottom: 15rpx;\r\n    }\r\n\r\n    .detail-content {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin: 0 10rpx 10rpx 10rpx;\r\n\r\n      .status {\r\n        font-size: 30rpx;\r\n        color: #ff0000;\r\n\r\n        .img {\r\n          width: 30rpx;\r\n          height: 30rpx;\r\n          margin-right: 10rpx;\r\n        }\r\n      }\r\n\r\n      .population {\r\n        font-size: 30rpx;\r\n        color: #000000;\r\n\r\n        .img {\r\n          width: 30rpx;\r\n          height: 30rpx;\r\n          margin-right: 10rpx;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .middle {\r\n    height: 500rpx;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    margin-bottom: 60rpx;\r\n\r\n    .sponsor {\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      font-size: 30rpx;\r\n      color: #000000;\r\n      border-bottom: 1px solid #d6d6d6;\r\n    }\r\n\r\n    .time {\r\n      font-size: 30rpx;\r\n      color: #000000;\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      border-bottom: 1px solid #d6d6d6;\r\n\r\n      .img {\r\n        width: 30rpx;\r\n        height: 30rpx;\r\n        margin-right: 10rpx;\r\n      }\r\n    }\r\n\r\n    .address {\r\n      font-size: 30rpx;\r\n      color: #000000;\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      border-bottom: 1px solid #d6d6d6;\r\n\r\n      .img {\r\n        width: 30rpx;\r\n        height: 30rpx;\r\n        margin-right: 10rpx;\r\n      }\r\n    }\r\n  }\r\n\r\n  .bottom {\r\n    flex: 1;\r\n\r\n    .sponsor-intro {\r\n      margin-bottom: 80rpx;\r\n\r\n      .title {\r\n        font-size: 30rpx;\r\n        color: grey;\r\n        margin-bottom: 10rpx;\r\n      }\r\n\r\n      .intro {\r\n        font-size: 30rpx;\r\n        color: #000000;\r\n      }\r\n    }\r\n\r\n    .activity-intro {\r\n      .title {\r\n        font-size: 30rpx;\r\n        color: grey;\r\n        margin-bottom: 10rpx;\r\n      }\r\n\r\n      .intro {\r\n        font-size: 30rpx;\r\n        color: #000000;\r\n      }\r\n    }\r\n  }\r\n\r\n  .footer {\r\n    .activity-btn {\r\n      margin-bottom: 45rpx;\r\n      display: flex;\r\n      justify-content: center;\r\n\r\n      .btn {\r\n        width: 40%;\r\n        margin-top: 50rpx;\r\n        font-size: 38rpx;\r\n      }\r\n      .hhh {\r\n        width: 100%;\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-content: center;\r\n        .hhh-btn {\r\n          width: 40%;\r\n          margin-bottom: 10rpx;\r\n        }\r\n        .span {\r\n          text-align: center;\r\n          color: #6b6a6a;\r\n          font-size: 15px;\r\n          // margin-bottom: 10rpx;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.code-view {\r\n  margin: 20rpx auto;\r\n  padding-bottom: 30rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/feidian/计算机设计大赛/xswc_cs/src/pages/activity/ActivityDetails.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","http","uni","wx","onLoad","onHide"],"mappings":"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"}